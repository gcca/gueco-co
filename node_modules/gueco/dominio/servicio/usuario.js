/*! \package gueco.dominio.servicio
 */

servicio_usuario.prototype.escenarios = function(usuario, retrollamada) {
    this.especificador_escenarios.fijar_especificante(usuario.escenarios)
    this.repositorio_escenario.buscar(this.especificador_escenarios,
                                      retrollamada)
}

servicio_usuario.prototype.autenticar = function(usuario_parbase,
                                                 retrollamada) {
    this.repositorio_usuario.uno(usuario_parbase, retrollamada)
}

servicio_usuario.prototype.almacenar_escenarios =
    function(usuario, escenarios, retrollamada) {

    var self = this
    if (escenarios instanceof Array) {
        var ids = []
        for (var i in escenarios) {
            this.repositorio_escenario.almacenar(escenarios[i],
                                                 function(error, escenario) {
                if (error) retrollamada(error)
                else ids.push(escenario.id)

                if (i == escenarios.length - 1) {
                    usuario.escenarios = usuario.escenarios.concat(ids)
                    self.repositorio_usuario.almacenar(usuario)
                    retrollamada(null)
                }
            })
        }
    } else {
        this.repositorio_escenario.almacenar(escenarios,
            function(error, id) {
            usuario.escenarios.push(id)
            self.repositorio_usuario.almacenar(usuario)
            retrollamada(error, id)
        })
    }
}

function servicio_usuario () {}

module.exports = servicio_usuario
